---
title: "Flux Kontext 图像生成 API"
description: "Wizzx 平台上的 Flux Kontext Pro/Max 文生图与图生图提交与查询说明"
---

## 快速上手

- 品牌：Wizzx（第三方 API 聚合），统一使用 `Authorization: Bearer <your_api_key>`.
- 提交生成：`POST /api/v1/task/submit/flux-kontext-pro` 或 `/flux-kontext-max`，异步返回 `task_id`。
- 轮询状态：`POST /api/v1/task/status`，传入 `task_id` 获取结果或错误。
- 两个模型：`flux-kontext-pro`（快速通用）和 `flux-kontext-max`（高质量精品）。
- 支持多种宽高比（21:9 至 9:21）、多参考图（最多 4 张）、提示词优化。

### 认证

所有请求需携带：

```bash
Authorization: Bearer <your_api_key>
```

Wizzx 网关会校验并注入身份，无需额外参数。

### 模型对比

| 特性 | Flux Kontext Pro | Flux Kontext Max |
|------|------------------|------------------|
| 基础费用 | 15 积分 | 20 积分 |
| 质量 | 高 | 更高 |
| 速度 | 快 | 较慢但质量更佳 |
| 适用场景 | 通用用途 | 精品输出 |

### 提交任务

接口：`POST /api/v1/task/submit/flux-kontext-pro` 或 `/flux-kontext-max`，`Content-Type: application/json`

| 字段 | 类型 | 说明 | 默认/规则 |
| --- | --- | --- | --- |
| `prompt` | string | 图像描述 | **必填** |
| `aspect_ratio` | string | 宽高比，支持 21:9 到 9:21 | 格式：`width:height`，如 "16:9", "1:1", "9:16" |
| `input_image` | string | 第一张参考图（Base64 或 URL） | 可选 |
| `input_image_2` | string | 第二张参考图（实验性） | 可选 |
| `input_image_3` | string | 第三张参考图（实验性） | 可选 |
| `input_image_4` | string | 第四张参考图（实验性） | 可选 |
| `output_format` | string | `jpeg` / `png` | 默认 `png` |
| `prompt_upsampling` | bool | 提示词优化增强 | 默认 `false` |
| `safety_tolerance` | int | 安全容忍度 0-6（0 最严格） | 默认 `2` |
| `seed` | int | 随机种子（可复现） | 可选 |
| `webhook_url` | string | Webhook 回调 URL | 可选，1-2083 字符 |
| `webhook_secret` | string | Webhook 签名密钥 | 可选 |

<Warning>
  **宽高比规则**：比例必须在 9:21（竖图）到 21:9（横图）之间。常用比例：1:1, 4:3, 3:2, 16:9, 9:16, 21:9, 9:21。

  **多参考图**：实验性功能，支持最多 4 张参考图，会产生额外费用（Pro +3 积分/张，Max +5 积分/张）。
</Warning>

#### 请求示例（Flux Kontext Pro，基础文生图）

```bash
curl -X POST https://api.wizzx.ai/api/v1/task/submit/flux-kontext-pro \
  -H "Authorization: Bearer <api_key>" \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "A futuristic city at night with neon lights",
    "aspect_ratio": "16:9",
    "output_format": "png",
    "safety_tolerance": 2
  }'
```

#### 请求示例（Flux Kontext Max，高质量 + 提示词优化）

```bash
curl -X POST https://api.wizzx.ai/api/v1/task/submit/flux-kontext-max \
  -H "Authorization: Bearer <api_key>" \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "A serene mountain landscape with a crystal clear lake",
    "aspect_ratio": "21:9",
    "output_format": "png",
    "safety_tolerance": 2,
    "prompt_upsampling": true,
    "seed": 42
  }'
```

#### 请求示例（多参考图）

```bash
curl -X POST https://api.wizzx.ai/api/v1/task/submit/flux-kontext-pro \
  -H "Authorization: Bearer <api_key>" \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "Combine the styles and elements from reference images",
    "aspect_ratio": "1:1",
    "input_image": "https://example.com/ref1.jpg",
    "input_image_2": "https://example.com/ref2.jpg",
    "input_image_3": "https://example.com/ref3.jpg",
    "output_format": "png"
  }'
```

成功响应示例：

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "task_id": "task_123456789",
    "status": "pending",
    "credits_deducted": 15
  }
}
```

### 任务查询

接口：`POST /api/v1/task/status`

请求体：

```json
{
  "task_id": "task_123456789"
}
```

响应示例（处理中）：

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "task_id": "task_123456789",
    "status": "processing",
    "result_urls": null
  }
}
```

响应示例（成功）：

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "task_id": "task_123456789",
    "status": "succeeded",
    "result_urls": [
      "https://cdn.example.com/images/result_123456789.png"
    ]
  }
}
```

响应示例（失败）：

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "task_id": "task_123456789",
    "status": "failed",
    "error_message": "Content policy violation",
    "result_urls": null
  }
}
```

状态值：`pending`（排队中）、`processing`（生成中）、`succeeded`（可用 `result_urls`）、`failed`（查看 `error_message`）。

### 计费详情

#### Flux Kontext Pro

按宽高比计费：
- 1:1：15 积分
- 16:9 / 9:16：18 积分
- 21:9 / 9:21：20 积分
- 4:3 / 3:4：16 积分
- 默认：15 积分

多参考图：每张额外参考图 +3 积分（从第二张开始）

#### Flux Kontext Max

按宽高比计费：
- 1:1：20 积分
- 16:9 / 9:16：25 积分
- 21:9 / 9:21：28 积分
- 4:3 / 3:4：22 积分
- 默认：20 积分

多参考图：每张额外参考图 +5 积分（从第二张开始）

### 参数速览与规则

- **必填**：`prompt`
- **可选**：`aspect_ratio`、`input_image`、`input_image_2`、`input_image_3`、`input_image_4`、`output_format`、`prompt_upsampling`、`safety_tolerance`、`seed`、`webhook_url`、`webhook_secret`
- **规则提示**：
  - 宽高比必须在 9:21 到 21:9 之间
  - 最多支持 4 张参考图
  - 安全容忍度：0（最严格）到 6（最宽松）
  - 输出格式：PNG 适合透明或高细节图，JPEG 适合照片或文件大小优先
  - 提示词优化会自动修改提示词以获得更好的创意效果

### 错误响应

#### 积分不足

```json
{
  "code": 402,
  "message": "insufficient credits",
  "data": null
}
```

#### 参数验证错误

```json
{
  "code": 400,
  "message": "validation error: invalid aspect_ratio: ratio must be between 9:21 (portrait) and 21:9 (landscape), got 5.000",
  "data": null
}
```

#### 模型未找到

```json
{
  "code": 404,
  "message": "model 'flux-kontext-pro' is not registered",
  "data": null
}
```

### 最佳实践

1. **宽高比选择**：
   - 1:1：社交媒体帖子
   - 16:9：横向风景图
   - 9:16：移动端竖图
   - 21:9：超宽电影感图像

2. **提示词优化**：
   - 具体详细的描述效果更好
   - 启用 `prompt_upsampling` 获得更具创意的解释
   - 包含风格关键词（如"photorealistic"、"oil painting"、"digital art"）

3. **多参考图**：
   - 用于保持一致的风格或构图
   - 注意：多参考图是实验性功能，可能影响结果
   - 每张额外图片会产生额外费用

4. **安全容忍度**：
   - 保持默认值 2 适用于一般用途
   - 降低值（0-1）用于严格内容过滤
   - 提高值（3-6）用于更宽松的过滤

5. **输出格式**：
   - PNG：透明或高细节图像
   - JPEG：照片或文件大小优先

6. **种子使用**：
   - 使用相同种子和参数可复现相似结果
   - 不同种子会生成变体

### 常见问题

- **需要回调吗？** 不需要，使用 `task/status` 轮询。也可以选择配置 `webhook_url` 接收回调。
- **如何复现结果？** 传入 `seed` 参数，使用相同参数会生成相似结果。
- **Pro 和 Max 该选哪个？** Pro 适合快速迭代和通用场景，Max 适合需要高质量精品输出的场景。
- **参考图有什么用？** 参考图可以引导生成风格、构图或元素，最多支持 4 张（实验性）。
- **提示词优化做什么？** 自动修改和增强提示词以获得更具创意和艺术性的生成结果。
